services:
  dozzle:
    image: amir20/dozzle:latest
    environment:
      - DOZZLE_MODE=swarm
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ${config}/dozzle:/config
    ports:
      - 8083:8080
    networks:
      - dozzle
      - traefik-public
    deploy:
      mode: global
      labels:
        - 'traefik.enable=true'
        - 'traefik.http.routers.dozzle.rule=Host(`dozzle`)'
        - 'traefik.http.services.dozzle.loadbalancer.server.port=8080'
        - 'traefik.http.routers.dozzle.entrypoints=web'
        - homepage.group=System Tools
        - homepage.name=Dozzle
        - homepage.icon=https://developer.asustor.com/uploadIcons/0020_117518_1660879946_dozzle_256.png
        - homepage.href=http://monitor.example.com:8083
        - homepage.description=stats
        - com.centurylinklabs.watchtower.enable: "true"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
networks:
  traefik-public:
    external: true
  dozzle:
    driver: overlay
